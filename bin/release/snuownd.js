/*
 snuownd.js - javascript port of reddit's "snudown" markdown parser
 https://github.com/gamefreak/snuownd
 Copyright (c) 2009, Natacha Port?
 Copyright (c) 2011, Vicent Marti
 Copyright (c) 2012, Scott McClaugherty

 Permission to use, copy, modify, and distribute this software for any
 purpose with or without fee is hereby granted, provided that the above
 copyright notice and this permission notice appear in all copies.

 THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
*/
(function(r){function x(a){return" "==a||"\n"==a}function A(a){return/[\x09-\x0d ]/.test(a)}function y(a){return/[A-Za-z0-9]/.test(a)}function ka(a){return/[\x20-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]/.test(a)}function H(a){return"%"+"0123456789ABCDEF"[(a&240)>>4]+"0123456789ABCDEF"[(a&15)>>0]}function P(a,c){var b,d=0,e=a.length;if(3>e||"<"!=a[0])return I;b=1;"/"==a[b]&&(d=1,b++);for(var f=0;b<e&&!(f>=c.length);++b,++f)if(a[b]!=c[f])return I;return b==e?I:A(a[b])||">"==a[b]?d?la:Sa:I}function ma(a,c){for(var b=
0,d;b<c.s.length;){for(d=b;b<c.s.length&&"\\"!=c.s[b];)b++;b>d&&(a.s+=c.s.slice(d,b));if(b+1>=c.s.length)break;a.s+=c.s[b+1];b+=2}}function w(a,c,b){for(var d=0,e,f=0;d<c.length;){for(e=d;d<c.length&&!(f=na[c.charCodeAt(d)]);)d++;d>e&&(a.s+=c.slice(e,d));if(d>=c.length)break;"/"!=c[d]||b?7!=na[c.charCodeAt(d)]&&(a.s+=Ta[f]):a.s+="/";d++}}function V(a,c){for(var b=0,d;b<c.length;){for(d=b;b<c.length&&1===oa[c.charCodeAt(b)];)b++;b>d&&(a.s+=c.slice(d,b));if(b>=c.length)break;if(2!=oa[c.charCodeAt(b)])switch(c[b]){case "&":a.s+=
"&amp;";break;case "'":a.s+="&#x27;";break;default:d=a.s;var e;e=c[b].charCodeAt(0);if(128>e)e=H(e);else{if(127<e&&2048>e)var f=H(e>>6&255|192);else f=H(e>>12&255|224),f+=H(e>>6&63|128);e=f+=H(e>>0&63|128)}a.s=d+e}b++}}function W(a,c,b,d){a=a.slice(b);for(d=b=0;d<c;++d)if("<"==a[d]){c=d;break}for(;0<c;){d=a[c-1];if("\x00"===d)break;if(-1!=="?!.,".indexOf(d))c--;else if(";"===d){for(d=c-2;0<d&&/[A-Za-z]/.test(a[d]);)d--;d<c-2&&"&"==a[d]?c=d:c--}else break}if(0==c)return 0;d=a[c-1];switch(d){case '"':b=
'"';break;case "'":b="'";break;case ")":b="(";break;case "]":b="[";break;case "}":b="{"}if(0!=b){for(var e=0,f=0,k=0;k<c;)a[k]==b?f++:a[k]==d&&e++,k++;e!=f&&c--}return c}function pa(a,c){var b,d=0;if(!y(a[0]))return 0;for(b=1;b<a.length-1;++b)if("."==a[b])d++;else if(!y(a[b])&&"-"!=a[b])break;return c?b:d?b:0}function X(a){var c="http:// https:// ftp:// mailto:// / git:// steam:// irc:// news:// mumble:// ssh:// ircs:// ts3server:// #".split(" "),b;for(b=0;b<c.length;++b){var d=c[b].length;if(a.length>
d&&0==a.toLowerCase().indexOf(c[b])&&/[A-Za-z0-9#\/?]/.test(a[d]))return 1}return 0}function Q(a){if(a)for(var c in a)c in this&&(this[c]=a[c])}function Y(a,c){this.callbacks=a;this.context=c}function Z(){return{nofollow:0,target:null,tocData:{headerCount:0,currentLevel:0,levelOffset:0},toc_id_prefix:null,html_element_whitelist:qa,html_attr_whitelist:ra,flags:0,link_attributes:function(a,c,b){b.nofollow&&(a.s+=' rel="nofollow"');null!=b.target&&(a.s+=' target="'+b.target+'"')}}}function sa(a){var c=
Z();c.flags=null==a?ta:a;a=new Y(ua(),c);a.context.flags&R&&(a.callbacks.image=null);a.context.flags&aa&&(a.callbacks.link=null,a.callbacks.autolink=null);if(a.context.flags&D||a.context.flags&J)a.callbacks.blockhtml=null;return a}function ua(){return new Q({blockcode:Ua,blockquote:Va,blockhtml:Wa,header:Xa,hrule:Ya,list:Za,listitem:$a,paragraph:ab,table:bb,table_row:cb,table_cell:db,autolink:eb,codespan:va,double_emphasis:wa,emphasis:xa,image:fb,linebreak:ya,link:gb,raw_html_tag:hb,triple_emphasis:za,
strikethrough:Aa,superscript:Ba,entity:null,normal_text:ib,doc_header:null,doc_footer:Ca})}function Da(){return new Q({blockcode:null,blockquote:null,blockhtml:null,header:jb,hrule:null,list:null,listitem:null,paragraph:null,table:null,table_row:null,table_cell:null,autolink:null,codespan:va,double_emphasis:wa,emphasis:xa,image:null,linebreak:null,link:kb,raw_html_tag:null,triple_emphasis:za,strikethrough:Aa,superscript:Ba,entity:null,normal_text:null,doc_header:null,doc_footer:lb})}function Ua(a,
c,b,d){a.s.length&&(a.s+="\n");if(b&&b.s.length){var e;a.s+='<pre><code class="';for(e=d=0;d<b.s.length;++d,++e){for(;d<b.s.length&&A(b.s[d]);)d++;if(d<b.s.length){for(var f=d;d<b.s.length&&!A(b.s[d]);)d++;"."==b.s[f]&&f++;e&&(a.s+=" ");w(a,b.s.slice(f,d),!1)}}a.s+='">'}else a.s+="<pre><code>";c&&w(a,c.s,!1);a.s+="</code></pre>\n"}function Va(a,c,b){a.s.length&&(a.s+="\n");a.s+="<blockquote>\n";c&&(a.s+=c.s);a.s+="</blockquote>\n"}function Wa(a,c,b){var d;if(c){for(d=c.s.length;0<d&&"\n"==c.s[d-1];)d--;
for(b=0;b<d&&"\n"==c.s[b];)b++;b>=d||(a.s.length&&(a.s+="\n"),a.s+=c.s.slice(b,d),a.s+="\n")}}function Xa(a,c,b,d){a.s.length&&(a.s+="\n");d.flags&ba?(a.s+="<h"+ +b+' id="',d.toc_id_prefix&&(a.s+=d.toc_id_prefix),a.s+="toc_"+d.tocData.headerCount++ +'">'):a.s+="<h"+ +b+">";c&&(a.s+=c.s);a.s+="</h"+ +b+">\n"}function Ya(a,c){a.s.length&&(a.s+="\n");a.s+=c.flags&E?"<hr/>\n":"<hr>\n"}function Za(a,c,b,d){a.s.length&&(a.s+="\n");a.s+=b&K?"<ol>\n":"<ul>\n";c&&(a.s+=c.s);a.s+=b&K?"</ol>\n":"</ul>\n"}function $a(a,
c,b,d){a.s+="<li>";if(c){for(b=c.s.length;b&&"\n"==c.s[b-1];)b--;a.s+=c.s.slice(0,b)}a.s+="</li>\n"}function ab(a,c,b){var d=0;a.s.length&&(a.s+="\n");if(c&&c.s.length){for(;d<c.s.length&&A(c.s[d]);)d++;if(d!=c.s.length){a.s+="<p>";if(b.flags&Ea)for(var e;d<c.s.length;){for(e=d;d<c.s.length&&"\n"!=c.data[d];)d++;d>e&&(a.s+=c.s.slice(e,d));if(d>=c.s.length-1)break;ya(a,b);d++}else a.s+=c.s.slice(d);a.s+="</p>\n"}}}function bb(a,c,b,d){a.s.length&&(a.s+="\n");a.s+="<table><thead>\n";c&&(a.s+=c.s);a.s+=
"</thead><tbody>\n";b&&(a.s+=b.s);a.s+="</tbody></table>\n"}function cb(a,c,b){a.s+="<tr>\n";c&&(a.s+=c.s);a.s+="</tr>\n"}function db(a,c,b,d,e){a.s=b&ca?a.s+"<th":a.s+"<td";1<e&&(a.s+=' colspan="'+e+'" ');switch(b&mb){case nb:a.s+=' align="center">';break;case Fa:a.s+=' align="left">';break;case Ga:a.s+=' align="right">';break;default:a.s+=">"}c&&(a.s+=c.s);a.s=b&ca?a.s+"</th>\n":a.s+"</td>\n"}function eb(a,c,b,d){if(!c||!c.s.length||0!=(d.flags&L)&&!X(c.s)&&b!=M)return 0;a.s+='<a href="';b==M&&
(a.s+="mailto:");V(a,c.s.slice(0));d.link_attributes?(a.s+='"',d.link_attributes(a,c,d),a.s+=">"):a.s+='">';0==c.s.indexOf("mailto:")?w(a,c.s.slice(7),!1):w(a,c.s,!1);a.s+="</a>";return 1}function va(a,c,b){a.s+="<code>";c&&w(a,c.s,!1);a.s+="</code>";return 1}function wa(a,c,b){if(!c||!c.s.length)return 0;a.s+="<strong>"+c.s+"</strong>";return 1}function xa(a,c,b){if(!c||!c.s.length)return 0;a.s+="<em>"+c.s+"</em>";return 1}function fb(a,c,b,d,e){if(!c||!c.s.length)return 0;a.s+='<img src="';V(a,
c.s);a.s+='" alt="';d&&d.s.length&&w(a,d.s,!1);b&&b.s.length&&(a.s+='" title="',w(a,b.s,!1));a.s+=e.flags&E?'"/>':'">';return 1}function ya(a,c){a.s+=c.flags&E?"<br/>\n":"<br>\n";return 1}function gb(a,c,b,d,e){if(null!=c&&0!=(e.flags&L)&&!X(c.s))return 0;a.s+='<a href="';c&&c.s.length&&V(a,c.s);b&&b.s.length&&(a.s+='" title="',w(a,b.s,!1));e.link_attributes?(a.s+='"',e.link_attributes(a,c,e),a.s+=">"):a.s+='">';d&&d.s.length&&(a.s+=d.s);a.s+="</a>";return 1}function hb(a,c,b){var d=b.html_element_whitelist;
if(0!=(b.flags&da)&&d)for(var e=0;d[e];e++){var f=P(c.s,d[e]);if(f!=I){d=d[e];b=b.html_attr_whitelist;var k=f,h=f=void 0,m=void 0,l=e=0,g=0,m=h=0,n=void 0,p=void 0,q=void 0;a.s+="<";if(k==la)a.s+="/"+d+">";else{a.s+=d;f=1+d.length;n=new v;for(p=new v;f<c.s.length&&!g;f++){q=c.s[f];h=m=g=0;switch(q){case ">":g=1;break;case "'":case '"':l?e?e==q?(e=0,h=1):p.s+=q:e=q:m=1;break;case " ":e?p.s+=" ":m=1;break;case "=":if(l){m=1;break}l=1;break;default:if(l&&e||!l)l?p.s+=q:n.s+=q}if(h){for(m=d=0;b[m];m++)if(b[m].length==
n.s.length){for(h=0;h<n.s.length&&b[m][h].toLowerCase()==n.s[h].toLowerCase();h++);if(h==n.s.length){d=1;break}}d&&p.s.length&&n.s.length&&(a.s+=" ",w(a,n.s,!1),a.s+='="',w(a,p.s,!1),a.s+='"');m=1}m&&(e=l=0,n=new v,p=new v)}a.s+=">"}return 1}}if(0!=(b.flags&J))return w(a,c.s,!1),1;if(0!=(b.flags&D)||0!=(b.flags&Ha)&&P(c.s,"style")||0!=(b.flags&aa)&&P(c.s,"a")||0!=(b.flags&R)&&P(c.s,"img"))return 1;a.s+=c.s;return 1}function za(a,c,b){if(!c||!c.s.length)return 0;a.s+="<strong><em>"+c.s+"</em></strong>";
return 1}function Aa(a,c,b){if(!c||!c.s.length)return 0;a.s+="<del>"+c.s+"</del>";return 1}function Ba(a,c,b){if(!c||!c.s.length)return 0;a.s+="<sup>"+c.s+"</sup>";return 1}function ib(a,c,b){c&&w(a,c.s,!1)}function jb(a,c,b,d){0==d.tocData.currentLevel&&(a.s+='<div class="toc">\n',d.tocData.levelOffset=b-1);b-=d.tocData.levelOffset;if(b>d.tocData.currentLevel)for(;b>d.tocData.currentLevel;)a.s+="<ul>\n<li>\n",d.tocData.currentLevel++;else if(b<d.tocData.currentLevel){for(a.s+="</li>\n";b<d.tocData.currentLevel;)a.s+=
"</ul>\n</li>\n",d.tocData.currentLevel--;a.s+="<li>\n"}else a.s+="</li>\n<li>\n";a.s+='<a href="#';d.toc_id_prefix&&(a.s+=d.toc_id_prefix);a.s+="toc_"+d.tocData.headerCount++ +'">';c&&w(a,c.s,!1);a.s+="</a>\n"}function kb(a,c,b,d,e){d&&d.s&&(a.s+=d.s);return 1}function Ca(a,c){c.tocData={headerCount:0,currentLevel:0,levelOffset:0}}function lb(a,c){for(var b=!1;0<c.tocData.currentLevel;)a.s+="</li>\n</ul>\n",c.tocData.currentLevel--,b=!0;b&&(a.s+="</div>\n");Ca(a,c)}function v(a){this.s=a||""}function Ia(){this.spanStack=
[];this.blockStack=[];this.extensions=ea|154;var a=sa();this.context=a.context;this.callbacks=a.callbacks;this.inLinkBody=0;this.activeChars={};this.refs={};this.nestingLimit=16;this.maxTableCols=64}function B(a){var c;for(c=0;c<a.length&&"\n"!=a[c];c++)if(" "!=a[c])return 0;return c+1}function fa(a){var c=0,b=0,d;if(3>a.length)return 0;" "==a[0]&&(c++," "==a[1]&&(c++," "==a[2]&&c++));if(c+2>=a.length||"*"!=a[c]&&"-"!=a[c]&&"_"!=a[c])return 0;for(d=a[c];c<a.length&&"\n"!=a[c];){if(a[c]==d)b++;else if(" "!=
a[c])return 0;c++}return 3<=b}function S(a,c){var b=0,d=0;var e=b=0,f;if(3>a.length)b=0;else if(" "==a[0]&&(b++," "==a[1]&&(b++," "==a[2]&&b++)),b+2>=a.length||"~"!=a[b]&&"`"!=a[b])b=0;else{for(f=a[b];b<a.length&&a[b]==f;)e++,b++;b=3>e?0:b}if(0==b)return 0;for(;b<a.length&&" "==a[b];)b++;e=b;if(b<a.length&&"{"==a[b]){b++;for(e++;b<a.length&&"}"!=a[b]&&"\n"!=a[b];)d++,b++;if(b==a.length||"}"!=a[b])return 0;for(;0<d&&x(a[e+0]);)e++,d--;for(;0<d&&x(a[e+d-1]);)d--;b++}else for(;b<a.length&&!x(a[b]);)d++,
b++;c&&(c.s=a.substr(e,d));for(;b<a.length&&"\n"!=a[b];){if(!x(a[b]))return 0;b++}return b+1}function ga(a,c){for(var b=1;b<a.length;){for(;b<a.length&&a[b]!=c&&"`"!=a[b]&&"["!=a[b];)b++;if(b==a.length)break;if(a[b]==c)return b;if(b&&"\\"==a[b-1])b++;else if("`"==a[b]){for(var d=0,e,f=0;b<a.length&&"`"==a[b];)b++,d++;if(b>=a.length)break;for(e=0;b<a.length&&e<d;)f||a[b]!=c||(f=b),"`"==a[b]?e++:e=0,b++;if(b>=a.length)return f}else if("["==a[b]){f=0;for(b++;b<a.length&&"]"!=a[b];)f||a[b]!=c||(f=b),
b++;for(b++;b<a.length&&(" "==a[b]||"\n"==a[b]);)b++;if(b>=a.length)return f;switch(a[b]){case "[":d="]";break;case "(":d=")";break;default:if(f)return f;continue}for(b++;b<a.length&&a[b]!=d;)f||a[b]!=c||(f=b),b++;if(b>=a.length)return f;b++}}return 0}function Ja(a,c,b,d){var e=b.slice(1);b=0;var f;if(!c.callbacks.emphasis)return 0;for(1<e.length&&e[0]==d&&e[1]==d&&(b=1);b<e.length;){f=ga(e.slice(b),d);if(!f)break;b+=f;if(b>=e.length)break;if(!(e[b]!=d||x(e[b-1])||c.extensions&ea&&"_"==d&&b+1!=e.length&&
!x(e[b+1])&&!ka(e[b+1])))return d=new v,c.spanStack.push(d),C(d,c,e.slice(0,b)),a=c.callbacks.emphasis(a,d,c.context),c.spanStack.pop(),a?b+1:0}return 0}function Ka(a,c,b,d){var e=b.slice(2);b=0;var f,k="~"==d?c.callbacks.strikethrough:c.callbacks.double_emphasis;if(!k)return 0;for(;b<e.length;){f=ga(e.slice(b),d);if(!f)break;b+=f;if(b+1<e.length&&e[b]==d&&e[b+1]==d&&b&&!x(e[b-1]))return d=new v,c.spanStack.push(d),C(d,c,e.slice(0,b)),a=k(a,d,c.context),c.spanStack.pop(),a?b+2:0;b++}return 0}function La(a,
c){if("#"!=c[0])return!1;if(a.extensions&64){for(var b=0;b<c.length&&6>b&&"#"==c[b];)b++;if(b<c.length&&" "!=c[b])return!1}return!0}function ha(a){var c=0,b=a.length;if("="==a[c]){for(c=1;c<b&&"="==a[c];c++);for(;c<b&&" "==a[c];)c++;return c>=b||"\n"==a[c]?1:0}if("-"==a[c]){for(c=1;c<b&&"-"==a[c];c++);for(;c<b&&" "==a[c];)c++;return c>=b||"\n"==a[c]?2:0}return 0}function Ma(a){for(var c=a.length,b=0;b<c&&"\n"!=a[b];)b++;return++b>=c?0:ha(a.slice(b))}function N(a){var c=0,b=a.length;c<b&&" "==a[c]&&
c++;c<b&&" "==a[c]&&c++;c<b&&" "==a[c]&&c++;return c<b&&">"==a[c]?c+1<b&&" "==a[c+1]?c+2:c+1:0}function Na(a){return 3<a.length&&" "==a[0]&&" "==a[1]&&" "==a[2]&&" "==a[3]?4:0}function T(a){var c=a.length,b=0;b<c&&" "==a[b]&&b++;b<c&&" "==a[b]&&b++;b<c&&" "==a[b]&&b++;if(b>=c||"0">a[b]||"9"<a[b])return 0;for(;b<c&&"0"<=a[b]&&"9">=a[b];)b++;return b+1>=c||"."!=a[b]||" "!=a[b+1]||Ma(a.slice(b))?0:b+2}function U(a){var c=a.length,b=0;b<c&&" "==a[b]&&b++;b<c&&" "==a[b]&&b++;b<c&&" "==a[b]&&b++;return b+
1>=c||"*"!=a[b]&&"+"!=a[b]&&"-"!=a[b]||" "!=a[b+1]||Ma(a.slice(b))?0:b+2}function ob(a,c){var b,d;if(3>a.length||"<"!=a[0])return 0;b="/"==a[1]?2:1;if(!y(a[b]))return 0;for(c.p=F;b<a.length&&(y(a[b])||"."==a[b]||"+"==a[b]||"-"==a[b]);)b++;if(1<b&&"@"==a[b]){a:{d=a.slice(b);for(var e=0,f=0,e=0;e<d.length;++e)if(!y(d[e]))switch(d[e]){case "@":f++;case "-":case ".":case "_":break;case ">":d=1==f?e+1:0;break a;default:d=0;break a}d=0}if(0!=d)return c.p=M,b+d}2<b&&":"==a[b]&&(c.p=O,b++);if(b>=a.length)c.p=
F;else if(c.p){for(d=b;b<a.length;)if("\\"==a[b])b+=2;else if(">"==a[b]||"'"==a[b]||'"'==a[b]||" "==a[b]||"\n"==a[b])break;else b++;if(b>=a.length)return 0;if(b>d&&">"==a[b])return b+1;c.p=F}for(;b<a.length&&">"!=a[b];)b++;return b>=a.length?0:b+1}function C(a,c,b){var d=0,e=0,f=0,k=new v;if(!(c.spanStack.length+c.blockStack.length>c.nestingLimit))for(;d<b.length;){for(;e<b.length&&!(f=c.activeChars[b[e]]);)e++;c.callbacks.normal_text?(k.s=b.slice(d,e),c.callbacks.normal_text(a,k,c.context)):a.s+=
b.slice(d,e);if(e>=b.length)break;d=e;e=(e=pb[f](a,c,b,d))?d+=e:d+1}}function Oa(a,c,b,d){var e,f=0,k=null,h,m=new v(b);if(2>b.length||"<"!=b[0])return 0;for(e=1;e<b.length&&">"!=b[e]&&" "!=b[e];)e++;e<b.length&&(e=b.slice(1),k=-1!="p dl div math table ul del form blockquote figure ol fieldset h1 h6 pre script h5 noscript style iframe h4 ins h3 h2".split(" ").indexOf(e.toLowerCase())?e.toLowerCase():"");if(!k){if(5<b.length&&"!"==b[1]&&"-"==b[2]&&"-"==b[3]){for(e=5;e<b.length&&("-"!=b[e-2]||"-"!=
b[e-1]||">"!=b[e]);)e++;e++;e<size&&(f=B(b.slice(e)));if(f)return m.s=b.slice(0,e+f),d&&c.callbacks.blockhtml&&c.callbacks.blockhtml(a,m,c.context),m.s.length}if(4<b.length&&("h"==b[1]||"H"==b[1])&&("r"==b[2]||"R"==b[2])){for(e=3;e<b.length&&">"!=b[e];)e++;if(e+1<b.length&&(e++,f=B(b.slice(e))))return m.s=b.slice(0,e+f),d&&c.callbacks.blockhtml&&c.callbacks.blockhtml(a,m,c.context),m.s.length}return 0}e=1;h=0;if("ins"!=k&&"del"!=k)for(k=k.length,e=1;e<b.length;){for(e++;e<b.length&&("<"!=b[e-1]||
"/"!=b[e]);)e++;if(e+2+k>=b.length)break;var f=tag,l=b.slice(e-1),g=void 0,n=void 0;f.length+3>=l.length||l.slice(2).toLowerCase()!=f||">"!=l[f.length+2]?f=0:(g=f.length+3,n=0,g<l.length&&0==(n=B(l.slice(g)))?f=0:(g+=n,n=0,g<l.length&&(n=B(l.slice(g))),f=g+n));if(f){e+=f-1;h=1;break}}if(!h)return 0;m.s=m.s.slice(0,e);d&&c.callbacks.blockhtml&&c.callbacks.blockhtml(a,m,c.context);return e}function Pa(a,c,b,d){var e=b.length,f=0,k,h=null;for(c.blockStack.push(h=new v);f<e;){d={p:d};k=h;for(var m=c,
l=b.slice(f),g=d,n=l.length,p=null,q=null,r=0,t=void 0,ia=void 0,z=0,x=0,u=void 0,y=0,w=0,A=0;3>x&&x<n&&" "==l[x];)x++;(r=U(l))||(r=T(l));if(r){for(t=r;t<n&&"\n"!=l[t-1];)t++;m.spanStack.push(p=new v);m.spanStack.push(q=new v);p.s+=l.slice(r,t);for(r=t;r<n;){var D,E;for(t++;t<n&&"\n"!=l[t-1];)t++;if(B(l.slice(r,t)))y=1;else{for(u=0;4>u&&r+u<t&&" "==l[r+u];)u++;ia=u;m.flags&4&&0!=S(l.slice(r+u,t),null)&&(A=!A);A||(D=U(l.slice(r+u,t)),E=T(l.slice(r+u,t)));if(y&&(g.p&K&&D||!(g.p&K)&&E)){g.p|=8;break}if(D&&
!fa(l.slice(r+u,t))||E){y&&(w=1);if(ia==x)break;z||(z=p.s.length)}else if(y&&0==ia){g.p|=8;break}else y&&(p.s+="\n",w=1);y=0;p.s+=l.slice(r+u,t)}r=t}w&&(g.p|=2);g.p&2?z&&z<p.s.length?(G(q,m,p.s.slice(0,z)),G(q,m,p.s.slice(z))):G(q,m,p.s):z&&z<p.s.length?(C(q,m,p.s.slice(0,z)),G(q,m,p.s.slice(z))):C(q,m,p.s);m.callbacks.listitem&&m.callbacks.listitem(k,q,g.p,m.context);m.spanStack.pop();m.spanStack.pop();k=r}else k=0;d=d.p;f+=k;if(!k||d&8)break}c.callbacks.list&&c.callbacks.list(a,h,d,c.context);c.blockStack.pop();
return f}function Qa(a,c,b,d,e){var f=0,k,h=null;if(c.callbacks.table_cell&&c.callbacks.table_row){c.spanStack.push(h=new v);f<b.length&&"|"==b[f]&&f++;for(k=0;k<d.length&&f<b.length;++k){var m,l,g;for(c.spanStack.push(g=new v);f<b.length&&x(b[f]);)f++;for(m=f;f<b.length&&"|"!=b[f];)f++;for(l=f-1;l>m&&x(b[l]);)l--;C(g,c,b.slice(m,1+l));c.callbacks.table_cell(h,g,d[k]|e,c.context,0);c.spanStack.pop();f++}b=d.length-k;0<b&&c.callbacks.table_cell(h,null,d[k]|e,c.context,b);c.callbacks.table_row(a,h,
c.context);c.spanStack.pop()}}function G(a,c,b){var d=0,e,f;if(!(c.spanStack.length+c.blockStack.length>c.nestingLimit))for(;d<b.length;)if(f=b.slice(d),La(c,f)){for(var k=a,h=c,m=0,l=void 0,g=void 0,n=void 0;m<f.length&&6>m&&"#"==f[m];)m++;for(l=m;l<f.length&&" "==f[l];l++);for(g=l;g<f.length&&"\n"!=f[g];g++);for(n=g;g&&"#"==f[g-1];)g--;for(;g&&" "==f[g-1];)g--;if(g>l){var p=new v;h.spanStack.push(p);C(p,h,f.slice(l,g));h.callbacks.header&&h.callbacks.header(k,p,m,h.context);h.spanStack.pop()}d+=
n}else if("<"==b[d]&&c.callbacks.blockhtml&&0!=(e=Oa(a,c,f,1)))d+=e;else if(0!=(e=B(f)))d+=e;else if(fa(f)){for(c.callbacks.hrule&&c.callbacks.hrule(a,c.context);d<b.length&&"\n"!=b[d];)d++;d++}else{if(k=0!=(c.extensions&4)){e=a;k=c;h=f;n=g=void 0;m=null;l=new v;g=S(h,l);if(0==g)e=0;else{m=new v;for(k.blockStack.push(m);g<h.length;){p=new v;n=S(h.slice(g),p);if(0!=n&&0==p.s.length){g+=n;break}for(n=g+1;n<h.length&&"\n"!=h[n-1];n++);g<n&&(g=h.slice(g,n),B(g)?m.s+="\n":m.s+=g);g=n}m.s.length&&"\n"!=
m.s[m.s.length-1]&&(m.s+="\n");k.callbacks.blockcode&&k.callbacks.blockcode(e,m,l.s.length?l:null,k.context);k.blockStack.pop();e=g}k=0!=e}if(k)d+=e;else{if(k=0!=(c.extensions&2)){e=a;k=c;h=f;l=m=n=void 0;g={p:null};k.spanStack.push(m=new v);k.blockStack.push(l=new v);for(var n=m,p=k,q=h,r=g,t=0,u=void 0,z=void 0,w=void 0,u=0;t<q.length&&"\n"!=q[t];)"|"==q[t++]&&u++;if(t==q.length||0==u)n=0;else{for(z=t;0<z&&x(q[z-1]);)z--;"|"==q[0]&&u--;z&&"|"==q[z-1]&&u--;if(u+1>p.maxTableCols)n=0;else{r.p=Array(u+
1);for(u=0;u<r.p.length;u++)r.p[u]=0;t++;t<q.length&&"|"==q[t]&&t++;for(w=t;w<q.length&&"\n"!=q[w];)w++;for(u=0;u<r.p.length&&t<w;++u){for(var A=0;t<w&&" "==q[t];)t++;":"==q[t]&&(t++,r.p[u]|=Fa,A++);for(;t<w&&"-"==q[t];)t++,A++;t<w&&":"==q[t]&&(t++,r.p[u]|=Ga,A++);for(;t<w&&" "==q[t];)t++;if(t<w&&"|"!=q[t])break;if(1>A)break;t++}u<r.p.length?n=0:(Qa(n,p,q.slice(0,z),r.p,ca),n=w+1)}}if(0<n){for(;n<h.length;){q=0;for(p=n;n<h.length&&"\n"!=h[n];)"|"==h[n++]&&q++;if(0==q||n==h.length){n=p;break}Qa(l,
k,h.slice(p,n),g.p,0);n++}k.callbacks.table&&k.callbacks.table(e,m,l,k.context)}k.spanStack.pop();k.blockStack.pop();k=0!=(e=n)}if(k)d+=e;else if(N(f)){k=a;h=c;m=f.length;l=void 0;g=0;n=void 0;p="";q=new v;h.blockStack.push(q);for(l=0;l<m;){for(g=l+1;g<m&&"\n"!=f[g-1];g++);if(n=N(f.slice(l,g)))l+=n;else if(B(f.slice(l,g))&&(g>=m||0==N(f.slice(g))&&!B(f.slice(g))))break;l<g&&(p+=f.slice(l,g));l=g}G(q,h,p);h.callbacks.blockquote&&h.callbacks.blockquote(k,q,h.context);h.blockStack.pop();d+=g}else if(Na(f)){k=
a;h=c;l=f;g=l.length;p=n=f=void 0;m=null;h.blockStack.push(m=new v);for(f=0;f<g;){for(n=f+1;n<g&&"\n"!=l[n-1];n++);if(p=Na(l.slice(f,n)))f+=p;else if(!B(l.slice(f,n)))break;f<n&&(B(l.slice(f,n))?m.s+="\n":m.s+=l.slice(f,n));f=n}for(l=m.s.length;l&&"\n"==m.s[l-1];)--l;m.s=m.s.slice(0,l);m.s+="\n";h.callbacks.blockcode&&h.callbacks.blockcode(k,m,null,h.context);h.blockStack.pop();d+=f}else if(U(f))d+=Pa(a,c,f,0);else if(T(f))d+=Pa(a,c,f,K);else{k=a;h=c;g=f;m=f=n=0;p=g.length;for(l=new v(g);n<p;){for(f=
n+1;f<p&&"\n"!=g[f-1];f++);if(0!=N(g.slice(n,f))){f=n;break}q=g.slice(n);if(B(q)||0!=(m=ha(q)))break;if(B(q))break;if(0!=(m=ha(q)))break;if(La(h,q)||fa(q)||N(q)){f=n;break}if(h.extensions&256&&!y(g[n])){if(T(q)||U(q)){f=n;break}if("<"==g[n]&&h.callbacks.blockhtml&&Oa(k,h,q,0)){f=n;break}if(0!=(h.extensions&&4)&&0!=S(q,null)){f=n;break}}n=f}for(p=n;p&&"\n"==g[p-1];)p--;l.s=l.s.slice(0,p);if(m){n=null;if(l.size){q=void 0;for(n=l.s.length;p&&"\n"!=g[p];)--p;for(q=p+1;p&&"\n"==g[p-1];)--p;l.s=l.s.slice(0,
p);0<p?(g=new v,h.blockStack.push(g),C(g,h,l.s),h.callbacks.paragraph&&h.callbacks.paragraph(k,g,h.context),h.blockStack.pop(),l.s=l.s.slice(q,n)):l.s=l.s.slice(0,n)}n=new v;h.spanStack.push(n);C(n,h,l.s);h.callbacks.header&&h.callbacks.header(k,n,m,h.context);h.spanStack.pop()}else g=new v,h.blockStack.push(g),C(g,h,l.s),h.callbacks.paragraph&&h.callbacks.paragraph(k,g,h.context),h.blockStack.pop();d+=f}}}}function qb(a,c,b,d){var e=0,f,k,h,m,l,g;if(c+3>=b||" "==a[c]&&(e=1," "==a[c+1]&&(e=2," "==
a[c+2]&&(e=3," "==a[c+3]))))return 0;e+=c;if("["!=a[e])return 0;e++;for(f=e;e<b&&"\n"!=a[e]&&"\r"!=a[e]&&"]"!=a[e];)e++;if(e>=b||"]"!=a[e])return 0;k=e;e++;if(e>=b||":"!=a[e])return 0;for(e++;e<b&&" "==a[e];)e++;e<b&&("\n"==a[e]||"\r"==a[e])&&(e++,e<b&&"\r"==a[e]&&"\n"==a[e-1]&&e++);for(;e<b&&" "==a[e];)e++;if(e>=b)return 0;"<"==a[e]&&e++;for(h=e;e<b&&" "!=a[e]&&"\n"!=a[e]&&"\r"!=a[e];)e++;for(m=">"==a[e-1]?e-1:e;e<b&&" "==a[e];)e++;if(e<b&&"\n"!=a[e]&&"\r"!=a[e]&&"'"!=a[e]&&'"'!=a[e]&&"("!=a[e])return 0;
g=0;if(e>=b||"\r"==a[e]||"\n"==a[e])g=e;e+1<b&&"\n"==a[e]&&"\r"==a[e+1]&&(g=e+1);if(g)for(e=g+1;e<b&&" "==a[e];)e++;c=l=0;if(e+1<b&&("'"==a[e]||'"'==a[e]||"("==a[e])){e++;for(c=e;e<b&&"\n"!=a[e]&&"\r"!=a[e];)e++;l=e+1<b&&"\n"==a[e]&&"\r"==a[e+1]?e+1:e;for(--e;e>c&&" "==a[e];)--e;e>c&&("'"==a[e]||'"'==a[e]||")"==a[e])&&(g=l,l=e)}if(!g||m==h)return 0;b=a.slice(f,k);e=a.slice(h,m);h=null;l>c&&(h=a.slice(c,l));d.refs[b]={id:b,link:new v(e),title:new v(h)};return g}var rb="&AElig; &Aacute; &Acirc; &Agrave; &Alpha; &Aring; &Atilde; &Auml; &Beta; &Ccedil; &Chi; &Dagger; &Delta; &ETH; &Eacute; &Ecirc; &Egrave; &Epsilon; &Eta; &Euml; &Gamma; &Iacute; &Icirc; &Igrave; &Iota; &Iuml; &Kappa; &Lambda; &Mu; &Ntilde; &Nu; &OElig; &Oacute; &Ocirc; &Ograve; &Omega; &Omicron; &Oslash; &Otilde; &Ouml; &Phi; &Pi; &Prime; &Psi; &Rho; &Scaron; &Sigma; &THORN; &Tau; &Theta; &Uacute; &Ucirc; &Ugrave; &Upsilon; &Uuml; &Xi; &Yacute; &Yuml; &Zeta; &aacute; &acirc; &acute; &aelig; &agrave; &alefsym; &alpha; &amp; &and; &ang; &apos; &aring; &asymp; &atilde; &auml; &bdquo; &beta; &brvbar; &bull; &cap; &ccedil; &cedil; &cent; &chi; &circ; &clubs; &cong; &copy; &crarr; &cup; &curren; &dArr; &dagger; &darr; &deg; &delta; &diams; &divide; &eacute; &ecirc; &egrave; &empty; &emsp; &ensp; &epsilon; &equiv; &eta; &eth; &euml; &euro; &exist; &fnof; &forall; &frac12; &frac14; &frac34; &frasl; &gamma; &ge; &gt; &hArr; &harr; &hearts; &hellip; &iacute; &icirc; &iexcl; &igrave; &image; &infin; &int; &iota; &iquest; &isin; &iuml; &kappa; &lArr; &lambda; &lang; &laquo; &larr; &lceil; &ldquo; &le; &lfloor; &lowast; &loz; &lrm; &lsaquo; &lsquo; &lt; &macr; &mdash; &micro; &middot; &minus; &mu; &nabla; &nbsp; &ndash; &ne; &ni; &not; &notin; &nsub; &ntilde; &nu; &oacute; &ocirc; &oelig; &ograve; &oline; &omega; &omicron; &oplus; &or; &ordf; &ordm; &oslash; &otilde; &otimes; &ouml; &para; &part; &permil; &perp; &phi; &pi; &piv; &plusmn; &pound; &prime; &prod; &prop; &psi; &quot; &rArr; &radic; &rang; &raquo; &rarr; &rceil; &rdquo; &real; &reg; &rfloor; &rho; &rlm; &rsaquo; &rsquo; &sbquo; &scaron; &sdot; &sect; &shy; &sigma; &sigmaf; &sim; &spades; &sub; &sube; &sum; &sup1; &sup2; &sup3; &sup; &supe; &szlig; &tau; &there4; &theta; &thetasym; &thinsp; &thorn; &tilde; &times; &trade; &uArr; &uacute; &uarr; &ucirc; &ugrave; &uml; &upsih; &upsilon; &uuml; &weierp; &xi; &yacute; &yen; &yuml; &zeta; &zwj; &zwnj;".split(" "),
na=[7,7,7,7,7,7,7,7,7,0,0,7,7,0,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,0,0,1,0,0,0,2,3,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,5,0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0],Ta=" &quot; &amp; &#39; &#47; &lt; &gt; ".split(" "),oa=[2,2,2,2,2,2,2,2,2,0,0,2,2,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,1,0,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];Q.prototype={blockcode:null,blockquote:null,blockhtml:null,header:null,hrule:null,list:null,listitem:null,paragraph:null,table:null,table_row:null,table_cell:null,autolink:null,codespan:null,double_emphasis:null,emphasis:null,image:null,linebreak:null,link:null,raw_html_tag:null,triple_emphasis:null,strikethrough:null,superscript:null,entity:null,normal_text:null,doc_header:null,doc_footer:null};r.createCustomRenderer=
function(a,c){return new Y(a,c)};r.defaultRenderState=Z;r.getRedditRenderer=sa;r.getTocRenderer=function(){var a=Z();a.flags=ba|D;return new Y(Da(),a)};r.createCustomCallbacks=function(a){return new Q(a)};r.getRedditCallbacks=ua;r.getTocCallbacks=Da;var pb=[null,function(a,c,b,d){b=b.slice(d);d=b[0];var e;if(2<b.length&&b[1]!=d)c="~"==d||x(b[1])||0==(e=Ja(a,c,b,d))?0:e+1;else if(3<b.length&&b[1]==d&&b[2]!=d)c=x(b[2])||0==(e=Ka(a,c,b,d))?0:e+2;else if(4<b.length&&b[1]==d&&b[2]==d&&b[3]!=d){var f;if(!(f=
"~"==d||x(b[3]))){a:{f=b.slice(3);e=0;for(var k;e<f.length;){k=ga(f.slice(e),d);if(!k)break;e+=k;if(f[e]==d&&!x(f[e-1])){if(e+2<f.length&&f[e+1]==d&&f[e+2]==d&&c.callbacks.triple_emphasis){b=new v;c.spanStack.push(b);C(b,c,f.slice(0,e));a=c.callbacks.triple_emphasis(a,b,c.context);c.spanStack.pop();c=a?e+3:0;break a}if(e+1<f.length&&f[e+1]==d){if(k=Ja(a,c,b,d)){c=k-2;break a}}else if(k=Ka(a,c,b,d)){c=k-1;break a}break}}c=0}f=0==(e=c)}c=f?0:e+3}else c=0;return c},function(a,c,b,d){d=b.slice(d);for(var e=
0,f,k;e<d.length&&"`"==d[e];)e++;f=0;for(b=e;b<d.length&&f<e;b++)"`"==d[b]?f++:f=0;if(f<e&&b>=d.length)return 0;for(f=e;f<b&&" "==d[f];)f++;for(k=b-e;k>e&&" "==d[k-1];)k--;f<k?(d=new v(d.slice(f,k)),c.callbacks.codespan(a,d,c.context)||(b=0)):c.callbacks.codespan(a,null,c.context)||(b=0);return b},function(a,c,b,d){b.slice(d);if(2>d||" "!=b[d-1]||" "!=b[d-2])return 0;for(b=a.s.length;b&&" "==a.s[b-1];)b--;a.s=a.s.slice(0,b);return c.callbacks.linebreak(a,c.context)?1:0},function(a,c,b,d){function e(){c.spanStack.length=
r;return u?h:0}var f=b.slice(d);b=d&&"!"==b[d-1];var k,h=1,m=0,l=0,g=0,n=0,p=d=null,q=null;k=null;var r=c.spanStack.length,t=0,u=0,w=0,y=0;if(b&&!c.callbacks.image||!b&&!c.callbacks.link)return e();for(k=1;h<f.length;h++)if("\n"==f[h])t=1;else if("\\"!=f[h-1])if("["==f[h])k++;else if("]"==f[h]&&(k--,0>=k))break;if(h>=f.length)return e();k=h;for(h++;h<f.length&&x(f[h]);)h++;if(h<f.length&&"("==f[h]){for(h++;h<f.length&&x(f[h]);)h++;for(m=h;h<f.length;)if("\\"==f[h])h+=2;else if(")"==f[h])break;else if(1<=
h&&x(f[h-1])&&("'"==f[h]||'"'==f[h]))break;else h++;if(h>=f.length)return e();l=h;if("'"==f[h]||'"'==f[h]){y=f[h];w=1;h++;for(g=h;h<f.length;)if("\\"==f[h])h+=2;else if(f[h]==y)w=0,h++;else if(")"!=f[h]||w)h++;else break;if(h>=f.length)return e();for(n=h-1;n>g&&x(f[n]);)n--;"'"!=f[n]&&'"'!=f[n]&&(g=n=0,l=h)}for(;l>m&&x(f[l-1]);)l--;"<"==f[m]&&m++;">"==f[l-1]&&l--;l>m&&(p=new v,c.spanStack.push(p),p.s+=f.slice(m,l));n>g&&(q=new v,c.spanStack.push(q),q.s+=f.slice(g,n));h++}else if(h<f.length&&"["==
f[h]){p=new v;g=null;h++;for(m=h;h<f.length&&"]"!=f[h];)h++;if(h>=f.length)return e();l=h;if(m==l)if(t){t=new v;c.spanStack.push(t);for(g=1;g<k;g++)"\n"!=f[g]?t.s+=f[g]:" "!=f[g-1]&&(t.s+=" ");p.s=t.s}else p.s=f.slice(1);else p.s=f.slice(m,l);g=c.refs[p.s];if(!g)return e();p=g.link;q=g.title;h++}else{p=new v;g=null;if(t){t=new v;c.spanStack.push(t);for(g=1;g<k;g++)"\n"!=f[g]?t.s+=f[g]:" "!=f[g-1]&&(t.s+=" ");p.s=t.s}else p.s=f.slice(1,k);g=c.refs[p.s];if(!g)return e();p=g.link;q=g.title;h=k+1}1<k&&
(d=new v,c.spanStack.push(d),b?d.s+=f.slice(1,k):(c.inLinkBody=1,C(d,c,f.slice(1,k)),c.inLinkBody=0));if(p)k=new v,c.spanStack.push(k),ma(k,p);else return e();b?(a.s.length&&"!"==a.s[a.s.length-1]&&(a.s=a.s.slice(0,-1)),u=c.callbacks.image(a,k,q,d,c.context)):u=c.callbacks.link(a,k,q,d,c.context);return e()},function(a,c,b,d){b=b.slice(d);d={p:F};var e=ob(b,d),f=new v(b.slice(0,e)),k=0;2<e&&(c.callbacks.autolink&&d.p!=F?(k=new v,c.spanStack.push(k),f.s=b.substr(1,e-2),ma(k,f),k=c.callbacks.autolink(a,
k,d.p,c.context),c.spanStack.pop()):c.callbacks.raw_html_tag&&(k=c.callbacks.raw_html_tag(a,f,c.context)));return k?e:0},function(a,c,b,d){b=b.slice(d);d=new v;if(1<b.length){if(-1=="\\`*_{}[]()#+-.!:|&<>/^~".indexOf(b[1]))return 0;c.callbacks.normal_text?(d.s=b[1],c.callbacks.normal_text(a,d,c.context)):a.s+=b[1]}else 1==b.length&&(a.s+=b[0]);return 2},function(a,c,b,d){b=b.slice(d);d=1;var e,f=!1,k=!1,h=new v;d<b.length&&"#"===b[d]&&(f=!0,d++);d<b.length&&f&&"x"===b[d].toLowerCase()&&(k=!0,d++);
for(e=d;d<b.length;){var m=b[d];if(k){if(!/[0-9a-fA-F]/.test(m))break}else if(f){if(!/[0-9]/.test(m))break}else if(!y(m))break;d++}if(d>e&&d<b.length&&";"===b[d])d++;else return 0;if(f&&7<NaN-e)return 0;if(f){if(f=k?16:10,e=parseInt(b.slice(e),f),!(8<e&&11!==e&&12<e&&(14>e||31<e)&&(55296>e||57343<e)&&65534!==e&&65535!==e&&1114111>=e))return 0}else if(-1===rb.indexOf(b.slice(0,d)))return 0;c.callbacks.entity?(h.s=b.slice(0,d),c.callbacks.entity(a,h,c.context)):a.s+=b.slice(0,d);return d},function(a,
c,b,d){var e=b.slice(d),f=null,k=null;if(!c.callbacks.autolink||c.inLinkBody)return 0;f=new v;c.spanStack.push(f);var h=f,e=e.length,m=b.slice(d),l,g=0;if(4>e||"/"!=b[d+1]||"/"!=b[d+2])b=0;else{for(;g<d&&/[A-Za-z]/.test(b[d-g-1]);)g++;if(X(b.substr(d-g,e+g)))if(l=3,m=pa(m.slice(l),0&Ra),0==m)b=0;else{for(l+=m;l<e&&!A(b[d+l]);)l++;l=W(b,l,d,e);0==l?b=0:(h.s+=b.substr(d-g,l+g),k=g,b=l)}else b=0}0<b&&(0<k&&a.truncate(a.s.length-k),c.callbacks.autolink(a,f,O,c.context));c.spanStack.pop();return b},function(a,
c,b,d){var e=b.slice(d),f=null,k=null;if(!c.callbacks.autolink||c.inLinkBody)return 0;f=new v;c.spanStack.push(f);var h=f,e=e.length;b.slice(d);var m,l,g=0,n=0;for(l=0;l<d;++l){var p=b[d-l-1];if("\x00"==p)break;if(!y(p)&&-1==".+-_".indexOf(p))break}if(0==l)b=0;else{for(m=0;m<e;++m)if(p=b[d+m],!y(p))if("@"==p)g++;else if("."==p&&m<e-1)n++;else if("-"!=p&&"_"!=p)break;2>m||1!=g||0==n?b=0:(m=W(b,m,d,e),0==m?b=0:(h.s+=b.substr(d-l,m+l),k=l,b=m))}0<b&&(0<k&&a.truncate(a.s.length-k),c.callbacks.autolink(a,
f,M,c.context));c.spanStack.pop();return b},function(a,c,b,d){var e=b.slice(d),f=null,k=null,h=null,h=null;if(!c.callbacks.link||c.inLinkBody)return 0;f=new v;c.spanStack.push(f);var k=f,e=e.length,m=b.slice(d),l;if(0<d&&!ka(b[d-1])&&!A(b[d-1]))b=0;else if(4>e||"www."!=m.slice(0,4))b=0;else if(l=pa(m,0),0==l)b=0;else{for(;l<e&&!A(m[l]);)l++;l=W(b,l,d,e);0==l?b=0:(k.s+=m.slice(0,l),h=0,b=l)}0<b&&(k=new v,c.spanStack.push(k),k.s+="http://",k.s+=f.s,0<h&&a.truncate(a.s.length-h),c.callbacks.normal_text?
(h=new v,c.spanStack.push(h),c.callbacks.normal_text(h,f,c.context),c.callbacks.link(a,k,null,h,c.context),c.spanStack.pop()):c.callbacks.link(a,k,null,f,c.context),c.spanStack.pop());c.spanStack.pop();return b},function(a,c,b,d){var e=b.slice(d),f=null,k,h=null;if(!c.callbacks.autolink||c.inLinkBody)return 0;f=new v;c.spanStack.push(f);a:{k=f;var m=e.length,l=b.slice(d),g,n=!1;if(3>m)k=0;else if(0!=l.indexOf("/r/"))k=0;else{g=3;"all-"==l.substr(g-1,4).toLowerCase()&&(n=!0);do{var p=g,q=24;if(m>=
g+10&&"reddit.com"==l.substr(g,10).toLowerCase())g+=10,q=10;else{m>g+2&&"t:"==l.substr(g,2)&&(g+=2);if(!y(l[g])){k=0;break a}g+=1}for(;g<m&&(y(l[g])||"_"==l[g]);)g++;if(2>g-p||g-p>q){k=0;break a}}while(g<m&&("+"==l[g]||n&&"-"==l[g])&&g++);if(g<m&&"/"==l[g])for(;g<m&&(y(l[g])||"_"==l[g]||"/"==l[g]||"-"==l[g]);)g++;k.s+=l.slice(0,g);h=0;k=g}}if(0<k)0<h&&a.truncate(a.s.length-h),c.callbacks.autolink(a,f,O,c.context);else{k=f;e=e.length;b=b.slice(d);if(6>e)b=0;else if(0!=b.indexOf("/u/"))b=0;else if(d=
3,y(b[d])||"_"==b[d]||"-"==b[d]){for(d+=1;d<e&&(y(b[d])||"_"==b[d]||"/"==b[d]||"-"==b[d]);)d++;k.s+=b.slice(0,d);h=0;b=d}else b=0;0<(k=b)&&(0<h&&a.truncate(a.s.length-h),c.callbacks.autolink(a,f,O,c.context))}c.spanStack.pop();return k},function(a,c,b,d){b=b.slice(d);d=b.length;var e,f,k=null;if(!c.callbacks.superscript||2>d)return 0;if("("==b[1]){for(e=f=2;f<d&&")"!=b[f]&&"\\"!=b[f-1];)f++;if(f==d)return 0}else for(e=f=1;f<d&&!x(b[f]);)f++;if(0==f-e)return 2==e?3:0;k=new v;c.spanStack.push(k);C(k,
c,b.slice(e,f));c.callbacks.superscript(a,k,c.context);c.spanStack.pop();return 2==e?f+1:f}],K=1,u=0;u++;var ja=u++,sb=u++,tb=u++,ub=u++,vb=u++,wb=u++,xb=u++,yb=u++,zb=u++,Ab=u++,Bb=u++,Cb=u++,Ra=1,u=0,F=u++,O=u++,M=u++,ea=1,D=1,Ha=2,R=4,aa=8,L=32,ba=64,Ea=128,E=256,J=512,da=1024,Fa=1,Ga=2,nb=3,mb=3,ca=4,I=0,Sa=1,la=2;v.prototype.truncate=function(a){if(this.s.length<a)throw new RangeError("Buffer smaller than desired size");if(0>a)throw new RangeError("Size argument is negative");this.s=this.s.slice(0,
a)};Ia.prototype.render=function(a){var c=new v,b=0,d;for(this.refs={};b<a.length;){if(!(d=qb(a,b,a.length,this))){for(d=b;d<a.length&&"\n"!=a[d]&&"\r"!=a[d];)d++;if(d>b)for(var e=c,b=a.slice(b,d),f=0,k=0;f<b.length;){for(var h=f;f<b.length&&"\t"!=b[f];)f++,k++;f>h&&(e.s+=b.slice(h,f));if(f>=b.length)break;do e.s+=" ",k++;while(k%4);f++}for(;d<a.length&&("\n"==a[d]||"\r"==a[d]);){if("\n"==a[d]||d+1<a.length&&"\n"!=a[d+1])c.s+="\n";d++}}b=d}a=new v;this.callbacks.doc_header&&this.callbacks.doc_header(a,
this.context);c.s.length&&("\n"!=c.s[c.s.length-1]&&"\r"!=c.s[c.s.length-1]&&(c.s+="\n"),G(a,this,c.s));this.callbacks.doc_footer&&this.callbacks.doc_footer(a,this.context);return a.s};r.getParser=function(a,c,b,d){var e=new Ia;a&&(e.callbacks=a.callbacks);b&&(e.nestingLimit=b);b&&(e.maxTableCols=d);a&&(e.context=a.context);void 0!=c&&null!=c&&(e.extensions=c);a=e.callbacks;if(a.emphasis||a.double_emphasis||a.triple_emphasis)e.activeChars["*"]=ja,e.activeChars._=ja,e.extensions&16&&(e.activeChars["~"]=
ja);a.codespan&&(e.activeChars["`"]=sb);a.linebreak&&(e.activeChars["\n"]=tb);if(a.image||a.link)e.activeChars["["]=ub;e.activeChars["<"]=vb;e.activeChars["\\"]=wb;e.activeChars["&"]=xb;e.extensions&8&&(e.extensions&512||(e.activeChars["@"]=zb),e.activeChars[":"]=yb,e.activeChars.w=Ab,e.activeChars["/"]=Bb);e.extensions&128&&(e.activeChars["^"]=Cb);return e};var ta=D|R|L|J|E,Db=D|L|da|J|E,ra=["colspan","rowspan","cellspacing","cellpadding","scope"],qa="tr th td table tbody thead tfoot caption".split(" ");
r.DEFAULT_HTML_ELEMENT_WHITELIST=qa;r.DEFAULT_HTML_ATTR_WHITELIST=ra;r.DEFAULT_BODY_FLAGS=ta;r.DEFAULT_WIKI_FLAGS=Db;r.HTML_SKIP_HTML=D;r.HTML_SKIP_STYLE=Ha;r.HTML_SKIP_IMAGES=R;r.HTML_SKIP_LINKS=aa;r.HTML_EXPAND_TABS=16;r.HTML_SAFELINK=L;r.HTML_TOC=ba;r.HTML_HARD_WRAP=Ea;r.HTML_USE_XHTML=E;r.HTML_ESCAPE=J;r.HTML_ALLOW_ELEMENT_WHITELIST=da;r.MKDEXT_NO_INTRA_EMPHASIS=ea;r.MKDEXT_TABLES=2;r.MKDEXT_FENCED_CODE=4;r.MKDEXT_AUTOLINK=8;r.MKDEXT_STRIKETHROUGH=16;r.MKDEXT_SPACE_HEADERS=64;r.MKDEXT_SUPERSCRIPT=
128;r.MKDEXT_LAX_SPACING=256;r.MKDEXT_NO_EMAIL_AUTOLINK=512;r.SD_AUTOLINK_SHORT_DOMAINS=Ra;r.MKDA_NOT_AUTOLINK=F;r.MKDA_NORMAL=O;r.MKDA_EMAIL=M;"function"===typeof define&&define("snuownd",[],r)})("undefined"!==typeof exports?exports:"undefined"!==typeof window?window.SnuOwnd={}:{});
